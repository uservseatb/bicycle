var bicycle=function(){var a=function(){var a=$({});this.subscribe=function(b){a.bind(b.name,b.handler)},this.unsubscribe=function(b){a.unbind(b.name)},this.throwEvent=function(b){setTimeout(function(){a.trigger(b.name,[b.args])},0)}},b=function(a,b){this.name=a,this.args=b},c=function(a,b){this.name=a,this.handler=b};document.eventBus=new a;var d=document.eventBus,e={};$.extend(e,{_APP:{_START:"21c90023-52bd-4179-b07c-cf99fc90eda7",_Loaded:"ac7d1eb9-dede-4203-93e5-b0a868a3d193"},_VIEW:{_ATTACH:".view.attach.event",_ATTACHED:".view.attached.event",_DETACH:".view.detach.event",_BEFORE_DETACHED:".view.before.detached.event",_DETACHED:".view.detached.event",_SET_HANDLERS:".view.set.handlers.event"}});var f=!1,g=function(){var a={};this.put=function(b){a[b]?a[b]+=1:a[b]=1},this.drop=function(b){a[b]&&(a[b]=void 0,delete a[b])},this.check=function(b,c){!a[b]&&f&&(console.warn("there is no subscribers for event ["+b+"] in global event bus, please add subscribers to take some effect"),console.warn("passed args:"),console.warn(c),console.warn("---------------------------------------------------------------------------------------------------------------------------------------"))}},h=new g,i=function(){var a=this;this.on=function(a,b){var d=new c(a,b);j(d),h.put(a)},this.once=function(b,c){var d=function(d,e){a.off(b),c(d,e)};a.on(b,d)},this.many=function(b,c){$.each(b,function(){a.on(""+this,c)})},this.off=function(a){d.unsubscribe(new c(a)),h.drop(a)},this.sendRequest=function(a,c,e,f,g){d.throwEvent(new b(EVENTS.PAGE_EDITOR_MODEL.PEM_SEND_REQUEST,{data:c,url:e,method:f,callback:a,json:!!G.isNotUndefAndNull(g)&&g}))};var g=function(a){var c,b=a;this.model=function(a){return c=a,this},this.attach=function(){bc.trigger(b+e._VIEW._ATTACH,{model:c})},this.attachToContainer=function(a){bc.trigger(b+e._VIEW._ATTACH,{model:c,container:a})},this.detach=function(){bc.trigger(b+e._VIEW._DETACH)},this.setHandlers=function(a){bc.trigger(b+e._VIEW._SET_HANDLERS,{eventHandlers:a})}};this.view=function(a){return new g(a)},this.processTemplate=function(a,b){return k.processTemplate(a,b)},this.renderView=function(b,c,d,e,g){var h=e||function(){};if($(b)&&$(b).length>0){$(b).append(a.processTemplate(c,d));var j=k.viewElementSelectors(c),l=k.viewElementFunctionsClick(c);g=g||{};var m=i(g,j,l);f&&(console.log("EVENT BINDER`s call: ---------------------------------------"),console.log(c),console.log(g),console.log(d),console.log("------------------------------------------------------------")),h(g,d),m.size>0&&i(g,void 0,m.postBinding)}else console.error("container: '"+b+"' is not exist")};var i=function(a,b,c){var f,d={},e=0;for(f in b)if(b.hasOwnProperty(f)){var g=$(b[f]);g&&(a[f]=$(b[f]))}for(f in c)if(c.hasOwnProperty(f)){var h=a[f];h?$.each(c[f],function(b){var d=$(c[f][b]);d.length>0&&d.on("click",a[f])}):(e++,d[f]=c[f])}return{postBinding:d,size:e}};this.detachView=function(a,b){var c=$(a);if(c&&c.length>0){var d=c.find(b);d.length>0&&(d.off(),d.remove())}};var j=function(a){d.subscribe(a)};return this},j=function(a){var c,b=this,d={},f={},g={},h={},i=function(){b.on(a,j)},j=function(a,b){c=b.templateUrls,f=b.functions;var i=0,j=0;$.each(c,function(a){j++;var b=c[a];$.ajax({url:b,success:function(a){var c=k(a,b);g[b]=c.viewElementSelectors,h[b]=c.viewElementFunctionsClick,d[b]=doT.template(c.template),i++,j==i&&bc.trigger(e._APP._Loaded)}})})},k=function(a,b){a=a.replace(/\<\!\-\-.*?\-\-\>/gi,"");var c=a.match(/bc\-jq\-container\=\".*?\"/gi),d=a.match(/bc\-jq-el=\".*?\"/gi),e=a.match(/bc\-jq\-click=\".*?\"/gi),f={},g={};if(null!=c&&c.length>0){var h=c[0].substr(0,c[0].length-1).replace(/bc\-jq\-container\=\"/,"")+" ";null!=d&&$.each(d,function(a){var b=d[a].substr(0,d[a].length-1).replace(/bc\-jq-el=\"/,"").split(" ");f[b[1]]?console.error("you cant define equal element ids ["+b[1]+"]"):f[b[1]]=h+b[0]}),null!=e&&$.each(e,function(a){var b=e[a].substr(0,e[a].length-1).replace(/bc\-jq-click=\"/,"").replace(/\(\)/,"").split(" ");g[b[1]]?g[b[1]].push(h+b[0]):g[b[1]]=[h+b[0]]})}var i=a.replace(/bc\-jq\-container\=\".*?\"/gi,"").replace(/bc\-jq-el=\".*?\"/gi,"").replace(/bc\-jq\-click=\".*?\"/gi,"");return{viewElementSelectors:f,viewElementFunctionsClick:g,template:i}},l=function(a,b){var g,c=function(a,b){function c(a){function b(){return 0==a.indexOf("<bc ")}function c(){return/\>(.*?)\</gi.exec(a)[1]}function d(){var b=/bc[\s,\-](\w*)=\"([\w,\-]{1,})\"/gi.exec(a);return{name:b[1],value:b[2]}}var e=d(),g=c();if(e&&"apply"===e.name&&f[e.value]){var h=f[e.value](g);return b()?h:a}return a}return a.replace(b,c(b))},d=function(a){return a.match(/(\<bc\s.*?\<\/bc\>)/gi)||[]},e=function(a){return a.match(/(\<\w{1,30}\sbc\-.*?\<\/\w{1,30}\>)/gi)||[]},h=[];for(h=h.concat(d(a)),h=h.concat(e(a)),g=0;g<h.length;g++){var i=h[g];a=c(a,i)}return a};return this.processTemplate=function(a,b){var c=d[a];return l(c(b),b)},this.viewElementSelectors=function(a){return g[a]},this.viewElementFunctionsClick=function(a){return h[a]},i(),this};j.prototype=new i,j.prototype.constructor=j,document.templateProcessor=new j(e._APP._START);var k=document.templateProcessor,l=function(){var a=[],c={},g="";this.setWindowLocationHref=function(a){window.location.href=g+a},this.sendAjax=function(a){a.url=g+a.url,$.ajax(a)},this.setApiUrl=function(a){g=a},this.run=function(f){$.each(a,function(){m(this)}),f.templateUrls?d.throwEvent(new b(e._APP._START,{templateUrls:f.templateUrls,functions:c})):(console.info("template urls is not defined"),d.throwEvent(new b(e._APP._Loaded,{})))},this.createFunction=function(a,b){return b instanceof Function?void(""!==a?c[a]=b:console.error("name of function can not be empty")):void console.error("the function "+a+" is not a function")},this.createComponent=function(b,c){return b||console.error("name of component is required"),c instanceof Function?(c.prototype=new i,c.prototype.constructor=c,l(c,b),void a.push(c)):void console.error("component "+b+" is not a function. Please pass neme of the component before")},this.showDebug=function(a){f=a};var j=function(a){var c,d,f,g,h,b=this,i=function(){b.on(a+e._VIEW._ATTACH,function(c,d){d.container?b.attachToContainer(d.container,d.model):b.attach(d.model),bc.trigger(a+e._VIEW._ATTACHED,{model:d.model,viewScope:g},!1)}),b.on(a+e._VIEW._DETACH,function(){bc.trigger(a+e._VIEW._BEFORE_DETACHED,{},!1),b.detach(),bc.trigger(a+e._VIEW._DETACHED,{},!1)}),b.on(a+e._VIEW._SET_HANDLERS,function(a,b){g=b.eventHandlers})};return this.attach=function(a){b.detachView(h,"#"+c),b.renderView(h,d,a,f,g)},this.attachToContainer=function(a,e){a||(a="body",console.info("container is not defined, the view will attach to document body!")),b.detachView(a," #"+c),b.renderView(a,d,e,f,g)},this.detach=function(){b.detachView(h,"#"+c)},this.viewElementId=function(a){return c=a,this},this.template=function(a){return d=a,this},this.initView=function(a){return f=a,this},this.eventHandlers=function(a){return g=a,this},this.container=function(a){return h=a,this},i(),this};j.prototype=new i,j.prototype.constructor=j,this.createView=function(a){return a||console.error("view name should be defined"),new j(a)},this.clone=function(a){return a?JSON.parse(JSON.stringify(a)):null},this.trigger=function(a,c,e){c=c||{},d.throwEvent(new b(a,c)),void 0!=e&&1!=e||h.check(a,c)},this.processTemplate=function(a,b){return k.processTemplate(a,b)};var l=function(a,b){a.prototype.getName=function(){return b}},m=function(a){var b=new a;b.init?b.init(b):console.error("method init is not defined in "+b.getName())}};return l.prototype.Events=e,new l}();